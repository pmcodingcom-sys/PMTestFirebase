<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My First Firebase App</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f7f6; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
        h2 { color: #333; text-align: center; }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        button { width: 100%; padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-add { background: #007bff; color: white; }
        .btn-add:hover { background: #0056b3; }
        ul { list-style: none; padding: 0; width: 100%; margin-top: 20px; }
        li { background: #fff; margin-bottom: 8px; padding: 12px; border-radius: 6px; border-left: 5px solid #007bff; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .actions button { width: auto; padding: 5px 10px; margin-left: 5px; font-size: 12px; }
        .btn-delete { background: #ff4d4d; color: white; }
        .btn-edit { background: #ffc107; color: black; }
    </style>
</head>
<body>

<div class="container">
    <h2>Firebase CRUD üöÄ</h2>
    <input type="text" id="itemName" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ...">
    <button class="btn-add" onclick="handleSave()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

    <ul id="itemList"></ul>
</div>

<script type="module">
    // 1. ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ Firebase SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // 2. ‚ö†Ô∏è ‡∏ß‡∏≤‡∏á config ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏°‡∏≤‡∏à‡∏≤‡∏Å Firebase ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
    const firebaseConfig = {
      apiKey: "AIzaSyAHKKk7gGiXWpCQ__iVb5zC7pN-DndYcRw",
      authDomain: "pmcoding-d6006.firebaseapp.com",
      projectId: "pmcoding-d6006",
      storageBucket: "pmcoding-d6006.firebasestorage.app",
      messagingSenderId: "393268229281",
      appId: "1:393268229281:web:1708e1c4622af894222ce0",
      measurementId: "G-264D575CB6"
    };

    // 3. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const colRef = collection(db, "my_items"); // ‡∏ä‡∏∑‡πà‡∏≠ "‡∏ï‡∏≤‡∏£‡∏≤‡∏á" ‡πÉ‡∏ô Firebase

    // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (Create/Update) ---
    window.handleSave = async () => {
        const nameInput = document.getElementById('itemName');
        const name = nameInput.value;
        if (!name) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠!");

        try {
            await addDoc(colRef, { name: name, createdAt: new Date() });
            nameInput.value = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å
        } catch (e) { console.error(e); }
    };

    // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö Real-time (Read) ---
    const q = query(colRef, orderBy("createdAt", "desc"));
    onSnapshot(q, (snapshot) => {
        const list = document.getElementById('itemList');
        list.innerHTML = "";
        snapshot.forEach((itemDoc) => {
            const data = itemDoc.data();
            const li = document.createElement('li');
            li.innerHTML = `
                <span>${data.name}</span>
                <div class="actions">
                    <button class="btn-edit" onclick="editItem('${itemDoc.id}', '${data.name}')">‡πÅ‡∏Å‡πâ</button>
                    <button class="btn-delete" onclick="deleteItem('${itemDoc.id}')">‡∏•‡∏ö</button>
                </div>
            `;
            list.appendChild(li);
        });
    });

    // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: ‡∏•‡∏ö (Delete) ---
    window.deleteItem = async (id) => {
        if (confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö?")) {
            await deleteDoc(doc(db, "my_items", id));
        }
    };

    // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (Update) ---
    window.editItem = async (id, oldName) => {
        const newName = prompt("‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠:", oldName);
        if (newName && newName !== oldName) {
            await updateDoc(doc(db, "my_items", id), { name: newName });
        }
    };
</script>

</body>
</html>
